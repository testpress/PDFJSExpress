/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[15],{374:function(Da,xa,z){function na(w,aa,fa){aa.endsWith("/")||(aa+="/");fa=fa||{};var ja=fa.disableWebsockets||!1;this.fU=fa.singleServerMode||!1;null!=fa.customQueryParameters&&Object(h.b)("wvsQueryParameters",fa.customQueryParameters);aa.endsWith("blackbox/")||(aa+="blackbox/");this.$m=fa.uploadData||null;this.ow=fa.uriData||null;this.$M=fa.cacheKey||null;this.iR=fa.officeLocale||null;this.sE=Object(n.a)(aa,null,ja);this.Sf=
aa;this.IE=w;this.qf=null;this.wj=ia();this.Xl=ia();this.zy=!1;this.dg=this.Pd=this.je=this.We=null;this.wf=[];this.hz=[];this.cache={};this.timeStamp=0;this.Nf=[];this.dh=[];this.dF=null;this.AE=!1;this.qI=this.id=null;this.YG=this.KP=ka;this.sB=0;this.dG=!1;this.b8=1;this.xA={};this.Wr(!0)}function ia(){var w={promise:null,resolve:null,reject:null,state:0,result:null,request:null,mr:function(){return 1===(w.state&1)},X6:function(){return 2===(w.state&2)},Uh:function(){return!w.X6()&&!w.mr()},D6:function(){return 4===
(w.state&4)},rT:function(){w.state|=4}};w.promise=new Promise(function(aa,fa){w.resolve=function(){if(0===w.state||4===w.state)w.state=1,w.result=arguments[0],aa.apply(null,arguments)};w.reject=function(){if(0===w.state||4===w.state)w.state=2,fa.apply(null,arguments)}});return w}function ka(){return!1}function ea(w,aa,fa){if(!(aa in b))return!0;aa=b[aa];for(var ja=0;ja<aa.length;ja++){var ba=w;var ha=aa[ja];var da=fa;if(ha.name in ba){var la="",ua=!1;ba=ba[ha.name];switch(ha.type){case "s":la="String";
ua=Object(ca.isString)(ba);break;case "a":la="Array";ua=Object(ca.isArray)(ba);break;case "n":la="Number";ua=Object(ca.isNumber)(ba)&&Object(ca.isFinite)(ba);break;case "o":la="Object",ua=Object(ca.isObject)(ba)&&!Object(ca.isArray)(ba)}ua||da.reject('Expected response field "'+ha.name+'" to have type '+la);ha=ua}else da.reject('Response missing field "'+ha.name+'"'),ha=!1;if(!ha)return!1}return!0}z.r(xa);var ca=z(0);z.n(ca);var x=z(1);Da=z(46);var r=z(25),n=z(392),a=z(78),e=z(319),f=z(97),h=z(39),
y=z(140),b={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};na.prototype=Object(ca.extend)(na.prototype,{L0:function(){var w=this;
return new Promise(function(aa,fa){var ja=new XMLHttpRequest;ja.open("GET",w.Sf+"ck");ja.withCredentials=w.Eo();ja.onreadystatechange=function(){ja.readyState===XMLHttpRequest.DONE&&(200===ja.status?aa():fa())};ja.send()})},xba:function(w,aa){this.KP=w||ka;this.YG=aa||ka},oN:function(){var w=this;this.Xl=ia();this.wj=ia();return this.sE.UE().then(function(){w.zy=!1;w.id=null;w.AE=!1;return w.L0()})},eI:function(){this.KP();this.rG();this.We&&(this.We.Uh()?this.rf(this.We.request):this.We.mr()&&this.YG(this.We.result.url,
"pdf")&&(this.We=null,this.RS()));this.dg&&this.dg.Uh()&&this.rf(this.dg.request);this.je&&this.je.Uh()?this.rf(this.je.request):this.Pd&&this.Pd.Uh()&&this.zP(this.Pd.request);var w;for(w=0;w<this.Nf.length;w++)this.Nf[w]&&this.Nf[w]&&(this.Nf[w].Uh()?this.rf(this.Nf[w].request):this.Nf[w].mr()&&this.YG(this.Nf[w].result.url,"image")&&(this.Nf[w]=null,this.pB(w)));for(w=0;w<this.dh.length;w++)this.dh[w]&&this.dh[w]&&this.dh[w].Uh()&&!this.dh[w].D6()&&this.rf(this.dh[w].request);for(w=0;w<this.wf.length;w++)this.wf[w]&&
this.wf[w].Uh()&&this.rf(this.wf[w].request)},rG:function(w){var aa=this;this.zy||(this.timeStamp=Date.now(),this.sE.WI(function(fa){aa.q8(fa)},function(){return null},function(){return null},!0).then(function(){clearInterval(aa.gB);aa.gB=null},function(fa){aa.zy=!1;if(!aa.gB){var ja=0;aa.AE=!0;aa.qI=0;aa.gB=setInterval(function(){2>ja++?aa.eI():(clearInterval(aa.gB),w&&w.reject(f.a),Object(x.f)("WebViewerServer connection failed:"+fa))},5E3)}}),this.zy=!0)},Ida:function(){var w=this,aa=createPromiseCapability();
if(this.$m){var fa=new FormData;fa.append("file",this.$m.fileHandle,this.$m.fileHandle.name);var ja=this.$m.loadCallback;var ba="upload";var ha=this.$m.extension}else if(this.ow){fa={uri:this.ow.uri,oha:this.ow.shareId};fa=Object.keys(fa).map(function(ma){return ma+"="+(fa[ma]?encodeURIComponent(fa[ma]):"")}).join("&");var da="application/x-www-form-urlencoded; charset=UTF-8";ja=this.ow.loadCallback;ba="url";ha=this.ow.extension}else return Promise.resolve();var la=new XMLHttpRequest,ua=Object(r.j)(w.Sf,
"AuxUpload");ua=Object(y.a)(ua)+"&type="+ba+"&ext="+ha;la.open("POST",ua);la.withCredentials=this.Eo();da&&la.setRequestHeader("Content-Type",da);la.addEventListener("load",function(){if(la.readyState===la.DONE&&200===la.status){var ma=JSON.parse(la.response);w.IE=ma.uri;ja(ma);aa.resolve(ma)}});la.addEventListener("error",function(){aa.reject(la.statusText+" "+JSON.stringify(la))});this.$m&&null!=this.$m.onProgress&&(la.upload.onprogress=function(ma){w.$m.onProgress(ma)});la.send(fa);return aa.promise},
faa:function(w){this.password=w||null;this.wj.mr()||(this.wj=ia(),this.rf({t:"pages"}));return this.wj.promise},Jv:function(w){this.dF=w||null;this.wj.mr()||(this.rG(this.wj),this.rf({t:"pages"}));return this.wj.promise},qN:function(w){w=Object.assign(w,{uri:encodeURIComponent(this.IE)});this.dF&&(w.ext=this.dF);this.qf&&(w.c=this.qf);this.password&&(w.pswd=this.password);this.$M&&(w.cacheKey=this.$M);this.iR&&(w.locale=this.iR);return w},rf:function(w){w=this.qN(w);this.sE.send(w)},mk:function(w){return w},
q8:function(w){var aa=this,fa=w.data,ja=w.err,ba=w.t;switch(ba){case "upload":ja?aa.Jda.reject(ja):aa.Jda.resolve("Success");break;case "pages":ja?aa.wj.reject(ja):ea(fa,ba,aa.wj)&&aa.wj.resolve(fa);break;case "config":ja?aa.Xl.reject(ja):ea(fa,ba,aa.Xl)&&(fa.id&&(aa.id=fa.id),fa.auth&&(w=Object(h.a)("wvsQueryParameters"),w.auth=fa.auth,Object(h.b)("wvsQueryParameters",w)),fa.serverVersion&&(aa.bea=fa.serverVersion,Object(x.g)("[WebViewer Server] server version: "+aa.bea)),fa.serverID?(aa.sB=fa.serverID===
aa.qI&&aa.dG?aa.sB+1:0,aa.qI=fa.serverID):aa.sB=0,aa.dG=!1,aa.Xl.resolve(fa));break;case "health":ja?aa.Xl.reject(ja):ea(fa,ba,aa.Xl)&&(fa=fa.unhealthy,aa.fU&&fa?Object(x.i)("Server failed health check. Single server mode ignoring check."):!aa.Mfa&&fa&&1>=aa.sB&&(aa.dG=!0,aa.oN().then(function(){aa.eI()},function(){aa.eI()})));break;case "pdf":fa.url=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url));ja?aa.We.reject(ja):ea(fa,ba,aa.We)&&aa.We.resolve(fa);break;case "docmod":fa.url=Object(y.a)(aa.Sf+"../"+
encodeURI(fa.url));ja?aa.xA[fa.rID].reject(ja):ea(fa,ba,aa.We)&&aa.xA[fa.rID].resolve(fa);break;case "xod":if(ja)this.je&&this.je.Uh()&&this.je.reject(ja),this.Pd&&this.Pd.Uh()&&this.Pd.reject(ja);else if(fa.notFound)fa.noCreate||this.je&&this.je.Uh()&&this.je.resolve(fa),this.Pd&&this.Pd.Uh()&&this.Pd.resolve(fa);else{fa.url&&(fa.url=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url)));if(!this.Pd||this.Pd.mr())this.Pd=ia(),this.Pd.request={t:"xod",noCreate:!0};this.je||(this.je=ia(),this.je.request={t:"xod"});
this.Pd.resolve(fa);this.je.resolve(fa)}break;case "annots":if(ja)aa.dg.reject(ja);else if(ea(fa,ba,aa.dg)){aa.dg.rT();var ha=new XMLHttpRequest;w=aa.Sf+"../"+encodeURI(fa.url);var da=fa.hasAppearance?Object(y.a)(w+".xodapp"):null;ha.open("GET",Object(y.a)(w));ha.responseType="text";ha.withCredentials=this.Eo();ha.addEventListener("load",function(){ha.readyState===ha.DONE&&200===ha.status&&aa.dg.resolve({sJ:ha.response,LM:da})});ha.addEventListener("error",function(){aa.dg.reject(ha.statusText+" "+
JSON.stringify(ha))});ha.send()}break;case "image":var la=this.Nf[fa.p];ja?la.promise.reject(ja):ea(fa,ba,la)&&(la.result=fa,la.result.url=Object(y.a)(aa.Sf+"../"+encodeURI(la.result.url)),la.resolve(la.result));break;case "tiles":la=fa.rID;w=this.wf[la];this.wf[la]=null;this.hz.push(la);if(ja)w.reject(ja);else if(ea(fa,ba,w)){for(ja=0;ja<fa.tiles.length;ja++)fa.tiles[ja]=Object(y.a)(aa.Sf+"../"+encodeURI(fa.tiles[ja]));w.resolve(fa)}break;case "text":la=this.dh[fa.p];if(ja)la.reject(ja);else if(ea(fa,
ba,la)){la.rT();var ua=new XMLHttpRequest;fa=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url));ua.open("GET",fa);ua.withCredentials=this.Eo();ua.addEventListener("load",function(){ua.readyState===ua.DONE&&200===ua.status&&(la.result=JSON.parse(ua.response),la.resolve(la.result))});ua.addEventListener("error",function(ma){la.reject(ua.statusText+" "+JSON.stringify(ma))});ua.send()}break;case "progress":"loading"===fa.t&&aa.trigger(a.a.Events.DOCUMENT_LOADING_PROGRESS,[fa.bytes,fa.total])}},LO:function(){this.rG(this.Xl);
return this.Xl.promise},O3:function(){this.dg||(this.dg=ia(),this.dg.request={t:"annots"},this.rf(this.dg.request));return this.dg.promise},pB:function(w){this.Nf[w]||(this.Nf[w]=ia(),this.Nf[w].request={t:"image",p:w},this.rf(this.Nf[w].request));return this.Nf[w].promise},gaa:function(w){this.dh[w]||(this.dh[w]=ia(),this.dh[w].request={t:"text",p:w},this.rf(this.dh[w].request));return this.dh[w].promise},haa:function(w,aa,fa,ja){var ba=this.wf.length;this.hz.length&&(ba=this.hz.pop());this.wf[ba]=
ia();this.wf[ba].request={t:"tiles",p:w,z:aa,r:fa,size:ja,rID:ba};this.rf(this.wf[ba].request);return this.wf[ba].promise},RS:function(){this.We||(this.We=ia(),this.We.request={t:"pdf"},this.AE?this.We.resolve({url:this.IE}):this.rf(this.We.request));return this.We.promise},bP:function(w){var aa=this,fa=new XMLHttpRequest,ja=Object(y.a)(this.Sf+"aul")+"&id="+this.id,ba=new FormData,ha={};w.annots&&(ha.annots="xfdf");w.watermark&&(ha.watermark="png");w.redactions&&(ha.redactions="redact");ha={t:"docmod",
reqID:this.b8++,parts:ha};w.print&&(ha.print=!0);var da=this.qN(ha);ba.append("msg",JSON.stringify(da));return Promise.all([w.annots,w.watermark,w.redactions].map(function(la){return Promise.resolve(la)})).then(function(la){var ua=la[0],ma=la[1],ra=la[2];ua&&ba.append("annots",ua);ma&&ba.append("watermark",la.watermark);ra&&ba.append("redactions",ra);aa.xA[da.reqID]=ia();fa.open("POST",ja);fa.withCredentials=aa.Eo;la=new Promise(function(oa,sa){fa.onreadystatechange=function(){4===fa.readyState&&
(200===fa.status?oa():sa("An error occurred while sending down annotation data to the server"))}});fa.send(ba);return la.then(function(){return aa.xA[da.reqID].promise})})},zP:function(){this.Pd||(this.Pd=ia(),this.Pd.request={t:"xod",noCreate:!0},this.rf(this.Pd.request));return this.Pd.promise},iaa:function(){this.je||(this.je=ia(),this.je.request={t:"xod"},this.rf(this.je.request));return this.je.promise},Lm:function(){return!0},request:function(){},mS:function(){},abort:function(){for(var w=0;w<
this.wf.length;w++)this.wf[w]&&(this.wf[w].resolve(null),this.wf[w]=null,this.hz.push(w));this.close()},zB:function(w){this.qf=this.qf||{};this.qf.headers=w},dga:function(){return this.qf?Object(ca.omit)(this.qf.headers,["Cookie","cookie"]):null},Wr:function(w){this.qf=this.qf||{};this.qf.internal=this.qf.internal||{};this.qf.internal.withCredentials=w},Eo:function(){return this.qf&&this.qf.internal?this.qf.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(Da.a)(na);
Object(e.a)(na);Object(e.b)(na);xa["default"]=na},392:function(Da,xa,z){function na(x,r,n){function a(f,h){function y(ra){w().then(function(oa){da&&!la?setTimeout(function(){y(ra)},1):oa.send(JSON.stringify(ra))})}function b(ra,oa,sa,ta){var qa=window.createPromiseCapability(),wa=!1,Aa=qa;ja=ra;ba=oa;ha=sa;fa=null;ta&&(ra=Object(ea.a)("wvsQueryParameters"),ra.bcid=Object(ka.k)(8),Object(ea.b)("wvsQueryParameters",ra));try{ra=ua?ma+"/"+ua:ma+"/ws";ra=Object(ca.a)(ra);var Ga=new WebSocket(ra);Ga.onopen=
function(){qa.resolve();wa=!0;qa=null;da=!1;aa.resolve(Ga);ba&&ba()};Ga.onerror=function(Na){da=la=!0;qa&&qa.reject(Na);fa&&fa.reject()};Ga.onclose=function(){aa=window.createPromiseCapability();da=!0;fa||(fa=window.createPromiseCapability());fa.resolve();ha&&ha();ja&&wa&&ja({t:"health",data:{unhealthy:!0,isDead:!0}})};Ga.onmessage=function(Na){Na&&Na.data&&(Na=JSON.parse(Na.data),Na.hb?y({hb:!0}):Na.end?close():ja(Na))}}catch(Na){qa.reject(Na),qa=null}return Aa.promise}function w(){da&&ja&&b(ja);
return aa.promise}var aa=window.createPromiseCapability(),fa=null,ja,ba,ha=null,da=!1,la=!1,ua=h,ma=function(ra){var oa=ra.indexOf("://"),sa="ws://";0>oa?oa=0:(5===oa&&(sa="wss://"),oa+=3);var ta=ra.lastIndexOf("/");0>ta&&(ta=ra.length);return sa+ra.slice(oa,ta)}(f);return{send:y,WI:b,UE:function(){return fa?fa.promise:w().then(function(ra){fa=window.createPromiseCapability();ja=null;ra.close();return fa.promise})}}}function e(f){var h=f.lastIndexOf("/");0>h&&(h=f.length);return f.slice(0,h)}return window.WebSocket&&
!n?a(x,r):function(f,h){function y(ra){(ha?ha.promise:Promise.resolve(ba)).then(function(oa){var sa=new XMLHttpRequest,ta=ja?fa+"/"+ja+"pf":fa+"/pf";ta=Object(ca.a)(ta)+"&id="+oa;oa=new FormData;oa.append("data",JSON.stringify(ra));sa.open("POST",ta);sa.withCredentials=!0;sa.send(oa)})}function b(){ba=0;ha||(ha=window.createPromiseCapability())}function w(){aa=new XMLHttpRequest;var ra=fa+"/pf";ra+=0!==ba?"?id="+ba+"&uc="+ma:"?uc="+ma;ma++;aa.open("GET",ra,!0);aa.withCredentials=!0;aa.setRequestHeader("Cache-Control",
"no-cache");aa.setRequestHeader("X-Requested-With","XMLHttpRequest");var oa=aa,sa=!1;aa.onreadystatechange=function(){a:if(3<=oa.readyState&&!sa){try{var ta=oa.responseText.length}catch(Aa){Object(ia.g)("caught exception");break a}if(0<ta)try{var qa=oa.responseText.split("\n");for(qa[qa.length-1]&&qa.pop();0<qa.length&&3>qa[qa.length-1].length;)"]"===qa.pop()&&b();0<qa.length&&3>qa[0].length&&qa.shift();for(ta=0;ta<qa.length;++ta)qa[ta].endsWith(",")&&(qa[ta]=qa[ta].substr(0,qa[ta].length-1));0===
ba&&0<qa.length&&(ba=JSON.parse(qa.shift()).id,ta=ha,ha=null,ta.resolve(ba));var wa;for(ta=0;ta<qa.length;++ta)(wa=JSON.parse(qa[ta]))&&wa.end?close():wa&&wa.hb&&wa.id===ba?y({hb:!0}):ua(wa)}catch(Aa){}da||(sa=!0,w())}};aa.send()}var aa,fa=e(f),ja=h,ba=0,ha=window.createPromiseCapability(),da=!1,la=null,ua=null,ma=0;return{send:y,WI:function(ra,oa,sa){ua=ra;la=sa;da=!1;b();w();oa&&oa();return Promise.resolve()},UE:function(){b();ua=null;da=!0;la&&la();aa.abort();return Promise.resolve()}}}(x,r)}z.d(xa,
"a",function(){return na});var ia=z(1),ka=z(25),ea=z(39),ca=z(140)}}]);}).call(this || window)
